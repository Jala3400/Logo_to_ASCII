use std::process::Command;

#[test]
fn cross() {
    let output = Command::new("cargo")
        .arg("run")
        .arg("--")
        .arg("./images/sources/Cross_Calatrava.png")
        .arg("--verbose")
        .output()
        .expect("Failed to execute command");

    assert!(output.status.success());
    let stdout = String::from_utf8_lossy(&output.stdout);
    let expected = r#"
Characters:  .Â·'qpbd8
Char size: 8x16, Line gap: 0
Block size: 8x16
Image dimensions: 480x480
Number of characters: 60x30
                                                            
                            .88.                            
                          .888888.                          
                          '888888'                          
                     ....  '8888'  ....                     
                  .8888888. 8888 .8888888.                  
                  888888888888888888888888                  
                  8888   '88888888'   8888                  
                   '88Â·    '8888'    Â·88'                   
          .88888p.   '88p   8888   q88'   .q88888.          
         .88888888p     '8. 8888 .8'     q88888888.         
         88888   '8b     .8 8888 8.     d8'   88888         
         '8888.    '8. .. ' 8888 ' .. .8'    .8888'         
    .88Â·.  '888b..   ''''   8888   ''''   ..d888'  .Â·88.    
 ..888888888888888888888888888888888888888888888888888888.. 
  '888888888888888888888888888888888888888888888888888888'  
    '88'   .888b'    ....   8888   ....    'd888.   '88'    
         .8888'    d8'   .. 8888 ..   '8b    '8888.         
         88888   Â·88      8 8888 8      88Â·   88888         
         '88888888'     .8' 8888 '8.     '88888888'         
          '88888'    Â·88'   8888   '88Â·    '88888'          
                   d88'    p8888q    '88b                   
                  8888   .d888888b.   8888                  
                  888888888888888888888888                  
                  '8888888' 8888 '8888888'                  
                      '''  .8888.  '''                      
                          .888888.                          
                          '888888'                          
                             88                             
                                                            
[0m"#;
    assert_eq!(stdout.trim(), expected.trim());
}

#[test]
fn cross_n() {
    let output = Command::new("cargo")
        .arg("run")
        .arg("--")
        .arg("./images/sources/Cross_Calatrava.png")
        .arg("-n")
        .arg("--verbose")
        .output()
        .expect("Failed to execute command");

    assert!(output.status.success());
    let stdout = String::from_utf8_lossy(&output.stdout);
    let expected = r#"
Characters:  .Â·'qpbd8
Char size: 8x16, Line gap: 0
Block size: 8x16
Image dimensions: 480x480
Number of characters: 60x30
88888888888888888888888888888bd88888888888888888888888888888
88888888888888888888888888888  88888888888888888888888888888
888888888888888888888888888      d88888888888888888888888888
88888888888888888888888888q      p88888888888888888888888888
888888888888888888888888888p    q888888888888888888888888888
8888888888888888888       88    88       d888888888888888888
88888888888888888b                        d88888888888888888
88888888888888888b    888qp      qp888    d88888888888888888
888888888888888888bp  d8888p    q8888b  qd888888888888888888
88888888888     '888bq  '88b    d88'  pd888'     d8888888888
888888888b        d88888qpdb    dbqp88888b        d888888888
888888888     88bq  888888 b    d 888888  pd88     888888888
888888888q    8888bp 8888ppb    dpq8888 qd8888    p888888888
8888b  88888    888888qpp88b    d88qqp888888    88888  d8888
888                                                      888
8pqp                                                    qpq8
8888q qpq888   qpqp88888888b    d88888888ppqp   888pqp p8888
8888888888    p8888b p8bq88b    d88pd8q '8888q    8888888888
888888888     888b qd8888p b    d d8888bp d888     888888888
888888888p        q888888 qb    dp 888888p        q888888888
8888888888q     qq8888  pd8b    d8bq  8888pp     p8888888888
8888888888888888888   q8888      8888p   8888888888888888888
888888888888888888    8888        8888    888888888888888888
88888888888888888b                        d88888888888888888
888888888888888888q       pb    dq       p888888888888888888
888888888888888888888pppq88b    d88ppqq888888888888888888888
888888888888888888888888888      888888888888888888888888888
88888888888888888888888888q      p88888888888888888888888888
8888888888888888888888888888q  p8888888888888888888888888888
88888888888888888888888888888bd88888888888888888888888888888
[0m"#;
    assert_eq!(stdout.trim(), expected.trim());
}

#[test]
fn cross_all() {
    let output = Command::new("cargo")
        .arg("run")
        .arg("--")
        .arg("./images/sources/Cross_Calatrava.png")
        .arg("--dict")
        .arg("all")
        .arg("--verbose")
        .output()
        .expect("Failed to execute command");

    assert!(output.status.success());
    let stdout = String::from_utf8_lossy(&output.stdout);
    let expected = r#"
Characters:  `.-',:_~";!^r+><=*?|\L/icl)(Tv7ztJsY1x{Inuf}][CFjo23ya5SVeZ4wPhmkXGE$69qpAKbdUOgHD8RMW0&#%QNB@
Char size: 8x16, Line gap: 0
Block size: 8x16
Image dimensions: 480x480
Number of characters: 60x30
                             ,                              
                            _@@_                            
                          ,@@@@@@,                          
                          '@@@@@@'                          
                    _____  '@@@@'  _____                    
                  _@@@@@@@__@@@@__@@@@@@@_                  
                  @@@@@@@@@@@@@@@@@@B@@@@@                  
                  @@@g   `4@@@@@@#`   @@@@                  
            ___    4@@L    Y@@@@f    <@@P    ___            
          _@@@@@g_   "0@p_  @@@@  _g@B"   _g@@@@@_          
         ,@@@@@@@@L     "0L @@@@ /#"     /@@B@@@@@,         
         @@@@B   *@&     ,@ @@@@ @_     @@*   @@@@B         
         "@@@@_    *@_ ,,`" @@@@ "`,_ _@P    _@@@B"         
    _@@>____@@@@______"""___@@@@___"""______@@@@____<@@_    
___@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@___
 `"0@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#"` 
    "@#*`  _@@@#"`  ____,   @@@@   ,____  `"4@@@_  `*0B"    
         ,@@@@'    gB` ``,_ @@@@ _,`  `@g    '@@@@,         
         @@@@B  _<@#     `@ @@@@ @      V@L_  @@@@B         
         '@@@@@@@@F    __@" @@@@ "@__    *@@@@@@@@'         
          "@@@@@P   _<@@P   @@@@   *@@>_  `*@@@@B"          
                  ,@@@F    A@@@@&    *@@g                   
                  @@@B   _@@@@@@@&_   @@@@                  
                  @@@@@@@@@@@@@@@@@@@@@@@@                  
                  "@@@@@@B' @@@@ '@@@@@@B"                  
                     `""`  ,@@@@,  `""`                     
                          ,@@@@@@,                          
                          "@@@@@B"                          
                            `@@`                            
                                                            
[0m"#;
    assert_eq!(stdout.trim(), expected.trim());
}

#[test]
fn cross_w100_padx4() {
    let output = Command::new("cargo")
        .arg("run")
        .arg("--")
        .arg("./images/sources/Cross_Calatrava.png")
        .arg("-w")
        .arg("100")
        .arg("--padx")
        .arg("4")
        .arg("--verbose")
        .output()
        .expect("Failed to execute command");

    assert!(output.status.success());
    let stdout = String::from_utf8_lossy(&output.stdout);
    let expected = r#"
Characters:  .Â·'qpbd8
Char size: 8x16, Line gap: 0
Block size: 8x16
Original dimensions 480x480
Applied padding of 4x0
Image dimensions: 808x800
Number of characters: 101x50
                                                  p                                                  
                                                 .8.                                                 
                                                .888.                                                
                                             .q8888888p.                                             
                                            d88888888888b                                            
                                            '88888888888'                                            
                                             '888888888'                                             
                                     ....     '8888888'    .....                                     
                                .q888888888.   8888888   .888888888p.                                
                               8888888888888b .8888888. d8888888888888                               
                              88888888888888888888888888888888888888888                              
                              88888888'''8888888888888888888'''88888888                              
                              8888888      '8888888888888'      8888888                              
                               888888.       '888888888'       .888888                               
                     ....       '88888b.      888888888      .d88888'       ....                     
                  .88888888p.      '8888b.    '8888888'    .d8888'      .q88888888.                  
                 d888888888888.       '8888.  '8888888'  .8888'       .888888888888b                 
                p88888888888888p         '88b  8888888  d88'         q88888888888888q                
                88888888'  '88888          '8  8888888  8'          88888'  '88888888                
                8888888'      8888.        q8  8888888  8p        .8888      '8888888                
                88888888       '888.       '8' 8888888 '8'       .888'       88888888                
                 '8888888.       '888Â·.q8b     8888888     d8p.Â·888'       .8888888'                 
        d888p.      8888888p.       ''''''     8888888     ''''''       .q8888888      .q888b        
      .888888888888888888888888888888888888888888888888888888888888888888888888888888888888888.      
  .qp8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888pp.  
  ''888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888''  
      '888888888888888888888888888888888888888888888888888888888888888888888888888888888888888'      
        8888''      d888888''       ......     8888888     ......       ''888888b      ''8888        
                 .8888888'       .888'''88     8888888     88'''888.       '8888888.                 
                88888888       .888'       qp. 8888888 .pp       '888.       88888888                
                8888888'      d888         '8  8888888  8'         888b      '8888888                
                88888888.  .d8888          .8  8888888  8.          8888b.  .88888888                
                '88888888888888'         .888  8888888  888.         '88888888888888'                
                 8888888888888'      .q8888'  .8888888.  '8888p.      '8888888888888                 
                  '88888888''     .q88888'    '8888888'    '88888p.     ''88888888'                  
                       '        .88888'       888888888       '88888.        '                       
                               d88888'       d888888888b       '88888b                               
                              8888888      .8888888888888.      8888888                              
                              88888888pqq8888888888888888888ppq88888888                              
                              88888888888888888888888888888888888888888                              
                               8888888888888'  8888888  '8888888888888                               
                                ''888888888'   8888888   '888888888''                                
                                      '''     .8888888.     '''                                      
                                             .888888888.                                             
                                            .88888888888.                                            
                                            '88888888888'                                            
                                              '8888888'                                              
                                                '888'                                                
                                                 '8'                                                 
                                                  8                                                  
[0m"#;
    assert_eq!(stdout.trim(), expected.trim());
}

#[test]
fn cross_padx4_pady8() {
    let output = Command::new("cargo")
        .arg("run")
        .arg("--")
        .arg("./images/sources/Cross_Calatrava.png")
        .arg("--padx")
        .arg("4")
        .arg("--pady")
        .arg("8")
        .arg("--verbose")
        .output()
        .expect("Failed to execute command");

    assert!(output.status.success());
    let stdout = String::from_utf8_lossy(&output.stdout);
    let expected = r#"
Characters:  .Â·'qpbd8
Char size: 8x16, Line gap: 0
Block size: 8x16
Applied padding of 4x8
Image dimensions: 488x496
Number of characters: 61x31
                              .                              
                              8                              
                            q888p                            
                           8888888                           
                           '88888'                           
                   .qp888p  88888  q888pÂ·                    
                  .88888888p88888q88888888.                  
                  8888''''888888888''''8888                  
                   888.    '88888'    .888                   
           .Â·ppp.   '88b.   88888   .d88'   .qppÂ·.           
          Â·8888888.    'd8. 88888 .8b'    .8888888Â·          
          8888'''88b      ' 88888 '      d88'''8888          
          8888.   '88     8 b888d 8     88'   .8888          
     ..    '888Â·    '8q.8   88888   8.p8'    Â·888'    ..     
    q8888ppqd888888ppppppppp88888ppppppppp888888bpqp8888p    
 Â·888888888888888888888888888888888888888888888888888888888Â· 
    '8888'''8888888'''''''''88888'''''''''8888888'''8888'    
      '   .q888'    .8''8   b888d   8''8.    '888p.   '      
          8888'   .88     8 88888 8     88.   '8888          
          8888b..88'      d 88888 b      '88..d8888          
          '8888888'    .88' 88888 '88.    '8888888'          
            '''''   .88b'   88888   'd88.   '''''            
                  .888'    d88888b    '888.                  
                  8888b..q888888888p..d8888                  
                  '88888888'88888'88888888'                  
                    ''888'  p888q  '888''                    
                           .88888.                           
                           8888888                           
                            '888'                            
                              8                              
                              '                              
[0m"#;
    assert_eq!(stdout.trim(), expected.trim());
}

#[test]
fn cross_csize17_center_padx4_n() {
    let output = Command::new("cargo")
        .arg("run")
        .arg("--")
        .arg("./images/sources/Cross_Calatrava.png")
        .arg("--char-size")
        .arg("17")
        .arg("--center")
        .arg("--padx")
        .arg("4")
        .arg("-n")
        .arg("--verbose")
        .output()
        .expect("Failed to execute command");

    assert!(output.status.success());
    let stdout = String::from_utf8_lossy(&output.stdout);
    let expected = r#"
Characters:  Â·.'pbqd8
Char size: 9x17, Line gap: 0
Block size: 9x17
Applied padding of 7x6
Image dimensions: 494x492
Number of characters: 55x29
Unfilled space: 1x1 pixels
888888888888888888888888888d888888888888888888888888888
888888888888888888888888888 888888888888888888888888888
8888888888888888888888888     8888888888888888888888888
888888888888888888888888p     q888888888888888888888888
8888888888888888888888888p   q8888888888888888888888888
888888888888888888      8b   d8      d88888888888888888
8888888888888888b                     d8888888888888888
8888888888888888b   d88qp     qq88b   d8888888888888888
88888888888888888qp  8888     8888  qd88888888888888888
8888888888      888qqp 88p   q88 qqd888      8888888888
888888888    qqp d8888qpdb   dbqd8888b qqp    888888888
888888888    888q  8888' b   d d8888  q888    888888888
888888888qp   8888q 8b'88b   d88'd8 q8888   qd888888888
8888b   '88     '''''''''     '''''''''     8''   d8888
88p                                                 q88
8888p   qqq     qqqppqqqqp   qqqqqqqqqq    qqqq   q8888
88888qd888   qd8888 qqq88b   d88qqq d888qp  '888qd88888
888888888    8888 q8888p b   d q8888p 8888    888888888
888888888     '  q88888bqb   dpd88888p  '    q888888888
888888888bp    qq888' qq8b   d8q  8888q     qd888888888
888888888888qq8888  qq888     888q   8888qq888888888888
8888888888888888b   d888       888b   d8888888888888888
8888888888888888b                     d8888888888888888
88888888888888888q     qdb   dq      q88888888888888888
88888888888888888888qqq88    d88qqq88888888888888888888
888888888888888888888888b     d888888888888888888888888
888888888888888888888888qp   qq888888888888888888888888
88888888888888888888888888q d88888888888888888888888888
888888888888888888888888888q888888888888888888888888888
[0m"#;
    assert_eq!(stdout.trim(), expected.trim());
}
